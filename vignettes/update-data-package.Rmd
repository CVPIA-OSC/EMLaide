---
title: "Update Data Package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Update Data Package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(EMLaide)
```

## Updates to the EDI portal

This article describes how to update an EDI package using EMLaide. See the official EDI guidelines for when updating a package is appropriate at the link (here)[https://edirepository.org/resources/updating-a-data-package].

EDI updates are very similar to data package uploads.  

## Generate EML Document

To update an existing EDI package, you will have to first create a new EML with the updated tables and metadata. Please reference the article [Create EML from Template](https://cvpia-osc.github.io/EMLaide/articles/create-EML-from-template.html) to see specifications for creating an EML document using EMLaide.

### Updating the EDI identifier

When creating the EML document for an update (as opposed to a new EDI package), you must update your EDI identifier to reflect the version of the package:

```{r}
old_edi_number <- "edi.750.1" 
updated_edi_number <- "edi.750.2"
```

This will be reflected when you write the updated XML:

```{r, eval = FALSE}
eml_updated <- list(packageId = updated_edi_number,
                   system = "EDI",
                   access = add_access(),
                   dataset = dataset,
                   additionalMetadata = list(metadata = list(unitList = unitList)))

# write and validate updated EML document
EML::write_eml(eml, paste0(updated_edi_number, ".xml"))
EML::eml_validate(paste0(updated_edi_number, ".xml"))
```

## Permissions for updates

You must have the credentials for the account that uploaded the original EDI package in order to update it: 

* a valid edi username
* a valid edi password

## Updating the package manually

To update the edi package manually, you can 

## Updating using API or via portal 

